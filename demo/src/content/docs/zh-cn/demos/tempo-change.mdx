---
title: 节奏变更
description: 保持音高的时间拉伸和拉伸引擎演示
---

import TempoDemo from '../../../../components/demo/TempoDemo.astro';

基于 WSOLA 的保持音高时间拉伸功能演示。

- **节奏滑块**: 实时调整播放速度从 0.5x 到 2.0x
- **保持音高**: 启用 WSOLA 拉伸器（在不改变音高的情况下改变速度）
- **分块条**: 实时可视化每个分块的处理状态
- **缓冲健康度**: 显示流式缓冲区的健康状态

<TempoDemo locale="zh-cn" />

## 代码示例

### 保持音高播放

```ts
import { WaaPlayer } from "waa-play";

const player = new WaaPlayer();
const buffer = await player.load("/music.mp3");

// preservePitch: true 自动启用 WSOLA 拉伸器
const playback = player.play(buffer, {
  playbackRate: 1.5,
  preservePitch: true,
});

// 实时改变节奏
playback.setPlaybackRate(0.75);
```

### 监控拉伸器状态

```ts
import { onFrame } from "waa-play";

const stop = player.onFrame(playback, (snapshot) => {
  const { stretcher } = snapshot;
  if (stretcher) {
    console.log(`Buffer health: ${stretcher.bufferHealth}`);
    console.log(`Ahead: ${stretcher.aheadSeconds.toFixed(1)}s`);
    console.log(`Chunks: ${stretcher.chunkStates.join(", ")}`);
  }
});
```
