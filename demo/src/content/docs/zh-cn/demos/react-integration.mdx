---
title: React 集成
description: 在 React 中使用 waa-play 的交互式演示
---

import ReactPlayerDemo from '../../../../components/demo/ReactPlayerDemo.tsx';
import { Code } from '@astrojs/starlight/components';
import { reactPlayerDemo } from '../../../../snippets/demos/react-integration';

在 React 中使用 waa-play 的实际运行演示。使用 `useSyncExternalStore` 和 `subscribeSnapshot` / `getSnapshot` 来响应式管理播放状态。

<ReactPlayerDemo client:load locale="zh-cn" />

## 源代码

此演示的核心逻辑。省略了 UI 渲染代码。

<Code code={reactPlayerDemo} lang="tsx" />

## 要点

- **`usePlaybackSnapshot`**: 封装 `useSyncExternalStore` + `subscribeSnapshot` / `getSnapshot` 的通用 hook，将 Playback 状态作为 React state 订阅
- **`useReactPlayer`**: 将播放器生命周期（WaaPlayer 管理、缓冲区生成/加载、播放控制）整合到单个 hook 中，使组件仅负责视图渲染
- **BYO AudioContext**: `WaaPlayer` 内部管理 AudioContext。在用户手势后调用 `ensureRunning()` 以恢复
